<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Google Sheets - WordPress Claw</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--primary:#E53935;--text:#1a1a1a;--text-secondary:#666;--bg:#f8f9fa;--bg-card:#fff;--border:#e5e5e5}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Inter,sans-serif;color:var(--text);background:var(--bg)}
.dashboard{display:flex;min-height:100vh}
.sidebar{width:260px;background:var(--bg-card);border-right:1px solid var(--border);position:fixed;height:100vh;z-index:100}
.sidebar-header{padding:20px 24px;border-bottom:1px solid var(--border)}
.sidebar-logo{display:flex;align-items:center;gap:12px}
.sidebar-logo img{height:72px;width:auto;max-width:220px;object-fit:contain}
.sidebar-nav{flex:1;padding:16px 12px;overflow-y:auto}
.nav-section{margin-bottom:24px}
.nav-section-title{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--text-secondary);padding:0 12px;margin-bottom:8px}
.nav-item{display:flex;align-items:center;gap:12px;padding:10px 12px;border-radius:8px;text-decoration:none;color:var(--text-secondary);font-size:14px;font-weight:500;transition:all .2s}
.nav-item:hover{background:var(--bg);color:var(--text)}
.nav-item.active{background:rgba(229,57,53,.1);color:var(--primary)}
.nav-icon{width:20px;height:20px;display:flex;align-items:center;justify-content:center}
.main{flex:1;margin-left:260px;padding:32px}
h1{font-size:28px;margin-bottom:8px}
.subtitle{color:var(--text-secondary);margin-bottom:24px}
.card{background:var(--bg-card);border-radius:12px;padding:24px;margin-bottom:24px;box-shadow:0 2px 8px rgba(0,0,0,.08)}
.card h2{font-size:18px;margin-bottom:16px}
.btn{padding:10px 20px;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
.btn-primary{background:var(--primary);color:#fff}
.btn-primary:hover{background:#C62828}
.btn-danger{background:var(--error);color:#fff;margin-left:8px}
.btn-secondary{background:var(--bg);color:var(--text);border:1px solid var(--border);margin-left:8px}
.hidden{display:none!important}
table{width:100%;border-collapse:collapse;font-size:14px;margin-top:16px}
th,td{padding:12px;text-align:left;border-bottom:1px solid var(--border)}
th{background:var(--bg);font-weight:600;font-size:12px;text-transform:uppercase}
tr:hover{background:var(--bg)}
input[type=text]{width:100%;padding:12px 16px;border:1px solid var(--border);border-radius:8px;font-size:14px;margin:8px 0}
.empty-state{text-align:center;padding:40px;color:var(--text-secondary)}
.error-box{background:#ffebee;color:#c62828;padding:16px;border-radius:8px;margin:16px 0}
</style>
</head>
<body>
<div class="dashboard">
<aside class="sidebar">
<div class="sidebar-header"><a href="/" class="sidebar-logo"><img src="/assets/logo.png" alt="WordPress Claw"></a></div>
<nav class="sidebar-nav">
<div class="nav-section">
<div class="nav-section-title">Main</div>
<a href="index.html" class="nav-item"><span class="nav-icon">üìä</span>Dashboard</a>
<a href="articles.html" class="nav-item"><span class="nav-icon">üìù</span>Articles</a>
<a href="clawbot.html" class="nav-item"><span class="nav-icon">ü§ñ</span>ClawBot</a>
</div>
<div class="nav-section">
<div class="nav-section-title">Integrations</div>
<a href="google-sheets.html" class="nav-item active"><span class="nav-icon">üìä</span>Google Sheets</a>
<a href="connections.html" class="nav-item"><span class="nav-icon">üîó</span>Connections</a>
</div>
<div class="nav-section">
<div class="nav-section-title">Settings</div>
<a href="business-profile.html" class="nav-item"><span class="nav-icon">üè¢</span>Business Profile</a>
<a href="billing.html" class="nav-item"><span class="nav-icon">üí≥</span>Billing</a>
</div>
</nav>
</aside>
<main class="main">
<h1>Google Sheets</h1>
<p class="subtitle">View your spreadsheet data</p>
<div id="notConnected" class="card">
<h2>Connect Google Sheet</h2>
<p>Share your sheet with the service account email, then paste the URL below:</p>
<input type="text" id="sheetUrl" placeholder="https://docs.google.com/spreadsheets/d/...">
<br><br>
<button class="btn btn-primary" onclick="connect()">Connect</button>
<div id="connectError" class="error-box hidden"></div>
</div>
<div id="connected" class="card hidden">
<h2>Connected Sheet</h2>
<p id="sheetTitle" style="color:var(--text-secondary);word-break:break-all;margin:12px 0"></p>
<button class="btn btn-primary" onclick="loadData()">üîÑ Load Data</button>
<button class="btn btn-danger" onclick="disconnect()">Disconnect</button>
<div id="dataArea" style="margin-top:24px"></div>
</div>
</main>
</div>
<script>
const API=window.location.origin;
async function init(){try{const r=await fetch(API+"/api/sheets/status",{headers:{"Authorization":"Bearer "+localStorage.getItem("token")}});const d=await r.json();if(d.success&&d.data.connected){document.getElementById("notConnected").classList.add("hidden");document.getElementById("connected").classList.remove("hidden");document.getElementById("sheetTitle").textContent=d.data.spreadsheetUrl||"Connected";loadData()}}catch(e){console.error(e)}}
async function connect(){const url=document.getElementById("sheetUrl").value;if(!url)return alert("Please enter a spreadsheet URL");const btn=document.querySelector("#notConnected .btn-primary");btn.disabled=true;btn.textContent="Connecting...";try{const r=await fetch(API+"/api/sheets/connect",{method:"POST",headers:{"Content-Type":"application/json","Authorization":"Bearer "+localStorage.getItem("token")},body:JSON.stringify({spreadsheetUrl:url})});const d=await r.json();if(d.success){init()}else{document.getElementById("connectError").classList.remove("hidden");document.getElementById("connectError").textContent=d.error||"Failed to connect"}}catch(e){document.getElementById("connectError").classList.remove("hidden");document.getElementById("connectError").textContent="Error: "+e.message}finally{btn.disabled=false;btn.textContent="Connect"}}
async function disconnect(){if(!confirm("Disconnect this spreadsheet?"))return;try{const r=await fetch(API+"/api/connections",{headers:{"Authorization":"Bearer "+localStorage.getItem("token")}});const d=await r.json();if(d.success){const conn=d.data.connections.find(c=>c.type==="googlesheets");if(conn){await fetch(API+"/api/connections/"+conn.id,{method:"DELETE",headers:{"Authorization":"Bearer "+localStorage.getItem("token")}})}}location.reload()}catch(e){alert("Error: "+e.message)}}
async function loadData(){const area=document.getElementById("dataArea");area.innerHTML="Loading...";try{const r=await fetch(API+"/api/sheets/data",{headers:{"Authorization":"Bearer "+localStorage.getItem("token")}});const d=await r.json();if(!d.success){area.innerHTML="Error: "+(d.error||"Unknown error");return}const headers=d.data.headers||[];const rows=d.data.data||[];if(rows.length===0){area.innerHTML="No data found. Make sure your sheet has data rows below the header.";return}let html="<table><thead><tr>";headers.forEach(h=>html+="<th>"+h+"</th>");html+="</tr></thead><tbody>";rows.forEach(row=>{html+="<tr>";headers.forEach(h=>html+="<td>"+(row[h]||"")+"</td>");html+="</tr>"});html+="</tbody></table>";area.innerHTML=html}catch(e){area.innerHTML="Error loading data: "+e.message}}
init();
</script>
</body>
</html>
